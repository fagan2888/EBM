################################################################################
# Logfile for EBM simulation
# Henry Peterson 2018
################################################################################

---
# Unknown Date
---
# Some linear fits:

PLANCK OLR:
A: -652.8783145676047 W/m2, B: 3.1022145805413275 W/m2/K

Full OLR, WV Feedback:
A: -417.0478973801873 W/m2, B: 2.349441658553002 W/m2/K

Full OLR, No WV Feedback:
A: -383.62200068534526 W/m2, B: 2.2236068235897157 W/m2/K
A: -418.26464942476156 W/m2, B: 2.3554184845083475 W/m2/K    (starting at T_f from WV feedback)

Shell Somerville:
A: -999.1626913063144 W/m2, B: 4.033450693435474 W/m2/K      (k = 0.03)
A: -1417.4283920090295 W/m2, B: 5.681866740765462 W/m2/K     (k = 0.20)
        
---
# 7-20-2018
---
# A rough analysis of accuracy depending on dy, dy, an tol with linear olr
dy  dt  tol    T
0.5 1.0 0.01   279.82
0.5 1.0 0.001  279.88 ***
0.5 1.0 0.0001 279.89
0.5 0.5 0.01   279.82
0.5 0.5 0.001  279.87

---
# 7-26
---
# Some initial tests of RH profiles
sim0  | perturbation | lat0=15 | M=15 | full_no_wvf | RH_vert_profile=zero_top | RH_lat_profile=constant                     | scale_efe=False |
sim1  | perturbation | lat0=15 | M=15 | full_wvf    | RH_vert_profile=zero_top | RH_lat_profile=constant                     | scale_efe=False |
sim2  | perturbation | lat0=15 | M=15 | full_no_wvf | RH_vert_profile=steps    | RH_lat_profile=constant                     | scale_efe=False |
sim3  | perturbation | lat0=15 | M=15 | full_wvf    | RH_vert_profile=steps    | RH_lat_profile=constant                     | scale_efe=False |
sim4  | perturbation | lat0=15 | M=15 | full_no_wvf | RH_vert_profile=steps    | RH_lat_profile=gaussian                     | scale_efe=False |
sim5  | perturbation | lat0=15 | M=15 | full_wvf    | RH_vert_profile=steps    | RH_lat_profile=gaussian                     | scale_efe=False |
sim6  | perturbation | lat0=15 | M=15 | full_wvf    | RH_vert_profile=steps    | RH_lat_profile=gaussian                     | scale_efe=True  |
sim7  | perturbation | lat0=15 | M=15 | full_no_wvf | RH_vert_profile=steps    | RH_lat_profile=mid_level_gaussian           | scale_efe=False |
sim8  | perturbation | lat0=15 | M=15 | full_wvf    | RH_vert_profile=steps    | RH_lat_profile=mid_level_gaussian           | scale_efe=False |
sim9  | perturbation | lat0=15 | M=15 | full_wvf    | RH_vert_profile=steps    | RH_lat_profile=mid_level_gaussian           | scale_efe=True  |
sim10 | perturbation | lat0=15 | M=15 | full_no_wvf | RH_vert_profile=steps    | RH_lat_profile=mid_and_upper_level_gaussian | scale_efe=False |
sim11 | perturbation | lat0=15 | M=15 | full_wvf    | RH_vert_profile=steps    | RH_lat_profile=mid_and_upper_level_gaussian | scale_efe=False |
sim12 | perturbation | lat0=15 | M=15 | full_wvf    | RH_vert_profile=steps    | RH_lat_profile=mid_and_upper_level_gaussian | scale_efe=True  |

--> Noticed sharp dips in init OLR for the full_wvf runs with latitudinally varying RH

---
# 7-27
---
# Check the profiles for annual mean
sim13 | annual_mean_clark | lat0=None | M=None | full_wvf    | RH_vert_profile=zero_top | RH_lat_profile=constant | scale_efe=False |
sim14 | annual_mean_clark | lat0=None | M=None | full_no_wvf | RH_vert_profile=zero_top | RH_lat_profile=constant | scale_efe=False |
sim15 | annual_mean_clark | lat0=None | M=None | full_wvf    | RH_vert_profile=steps    | RH_lat_profile=constant | scale_efe=False |
sim16 | annual_mean_clark | lat0=None | M=None | full_no_wvf | RH_vert_profile=steps    | RH_lat_profile=constant | scale_efe=False |
sim17 | annual_mean_clark | lat0=None | M=None | full_wvf    | RH_vert_profile=steps    | RH_lat_profile=gaussian | scale_efe=False |
sim18 | annual_mean_clark | lat0=None | M=None | full_no_wvf | RH_vert_profile=steps    | RH_lat_profile=gaussian | scale_efe=False |

# Changes made to lats now -- must make new prescribed water vapor T arrays for each type of RH
# (The change was that lats did not contain 0, and thus the EFE was slightly offset all the time. Fixed now.)
sim19 | annual_mean_clark | full_wvf | RH_vert_profile=steps    | RH_lat_profile=constant                     |
sim20 | annual_mean_clark | full_wvf | RH_vert_profile=zero_top | RH_lat_profile=constant                     |
sim21 | annual_mean_clark | full_wvf | RH_vert_profile=steps    | RH_lat_profile=gaussian                     |
sim22 | annual_mean_clark | full_wvf | RH_vert_profile=steps    | RH_lat_profile=mid_level_gaussian           |
sim23 | annual_mean_clark | full_wvf | RH_vert_profile=steps    | RH_lat_profile=mid_and_upper_level_gaussian |

# Now redo the perturbations
sim24 | perturbation | lat0=15 | M=15 | full_wvf    | RH_vert_profile=steps    | RH_lat_profile=constant                     | scale_efe=False |
sim25 | perturbation | lat0=15 | M=15 | full_no_wvf | RH_vert_profile=steps    | RH_lat_profile=constant                     | scale_efe=False |
sim26 | perturbation | lat0=15 | M=15 | full_wvf    | RH_vert_profile=zero_top | RH_lat_profile=constant                     | scale_efe=False |
sim27 | perturbation | lat0=15 | M=15 | full_no_wvf | RH_vert_profile=zero_top | RH_lat_profile=constant                     | scale_efe=False |
sim28 | perturbation | lat0=15 | M=15 | full_wvf    | RH_vert_profile=steps    | RH_lat_profile=gaussian                     | scale_efe=False |
sim29 | perturbation | lat0=15 | M=15 | full_no_wvf | RH_vert_profile=steps    | RH_lat_profile=gaussian                     | scale_efe=False |
sim30 | perturbation | lat0=15 | M=15 | full_wvf    | RH_vert_profile=steps    | RH_lat_profile=mid_level_gaussian           | scale_efe=False |
sim31 | perturbation | lat0=15 | M=15 | full_no_wvf | RH_vert_profile=steps    | RH_lat_profile=mid_level_gaussian           | scale_efe=False |
sim32 | perturbation | lat0=15 | M=15 | full_wvf    | RH_vert_profile=steps    | RH_lat_profile=mid_and_upper_level_gaussian | scale_efe=False |
sim33 | perturbation | lat0=15 | M=15 | full_no_wvf | RH_vert_profile=steps    | RH_lat_profile=mid_and_upper_level_gaussian | scale_efe=False |
sim34 | perturbation | lat0=15 | M=15 | full_wvf    | RH_vert_profile=steps    | RH_lat_profile=gaussian                     | scale_efe=True  |
sim35 | perturbation | lat0=15 | M=15 | full_wvf    | RH_vert_profile=steps    | RH_lat_profile=mid_level_gaussian           | scale_efe=True  |
sim36 | perturbation | lat0=15 | M=15 | full_wvf    | RH_vert_profile=steps    | RH_lat_profile=mid_and_upper_level_gaussian | scale_efe=True  |

# the efe logs:
FOLDER L0  SIG   M   EFE
sim24: 15, 4.94, 15, -6.4752348845995886
sim25: 15, 4.94, 15, -5.0940033650012930
sim26: 15, 4.94, 15, -6.1948242987685704
sim27: 15, 4.94, 15, -4.7757420199444205
sim28: 15, 4.94, 15, -7.2394332459199893
sim29: 15, 4.94, 15, -5.6341989642593902
sim30: 15, 4.94, 15, -6.4627919835991019
sim31: 15, 4.94, 15, -4.1669575379738646
sim32: 15, 4.94, 15, -6.4799025209573653
sim33: 15, 4.94, 15, -4.1489327123277508
sim34: 15, 4.94, 15, -7.1196716893246927
sim35: 15, 4.94, 15, -6.0080486755648836
sim36: 15, 4.94, 15, -6.0063756769752317

---
# 7-31
---
# Run some sensitivity experiments for mid_level_gaussian
sim37 | perturbation | lat0=15 | M=5  | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=10 |
sim38 | perturbation | lat0=15 | M=10 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=10 |
sim39 | perturbation | lat0=15 | M=15 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=10 |
sim40 | perturbation | lat0=15 | M=18 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=10 |
sim41 | perturbation | lat0=60 | M=5  | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=10 |
sim42 | perturbation | lat0=60 | M=10 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=10 |
sim43 | perturbation | lat0=60 | M=15 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=10 |
sim44 | perturbation | lat0=60 | M=18 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=10 |

sim45 | perturbation | lat0=15 | M=5  | full_no_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=10 |
sim46 | perturbation | lat0=15 | M=10 | full_no_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=10 |
sim47 | perturbation | lat0=15 | M=15 | full_no_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=10 |
sim48 | perturbation | lat0=15 | M=18 | full_no_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=10 |
sim49 | perturbation | lat0=60 | M=5  | full_no_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=10 |
sim50 | perturbation | lat0=60 | M=10 | full_no_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=10 |
sim51 | perturbation | lat0=60 | M=15 | full_no_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=10 |
sim52 | perturbation | lat0=60 | M=18 | full_no_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=10 |

sim53 | perturbation | lat0=15 | M=5  | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=5  |
sim54 | perturbation | lat0=15 | M=10 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=5  |
sim55 | perturbation | lat0=15 | M=15 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=5  |
sim56 | perturbation | lat0=15 | M=18 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=5  |
sim57 | perturbation | lat0=60 | M=5  | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=5  |
sim58 | perturbation | lat0=60 | M=10 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=5  |
sim59 | perturbation | lat0=60 | M=15 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=5  |
sim60 | perturbation | lat0=60 | M=18 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=5  |

sim61 | perturbation | lat0=15 | M=5  | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=2  |
sim62 | perturbation | lat0=15 | M=10 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=2  |
sim63 | perturbation | lat0=15 | M=15 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=2  |
sim64 | perturbation | lat0=15 | M=18 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=2  |
sim65 | perturbation | lat0=60 | M=5  | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=2  |
sim66 | perturbation | lat0=60 | M=10 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=2  |
sim67 | perturbation | lat0=60 | M=15 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=2  |
sim68 | perturbation | lat0=60 | M=18 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=2  |

sim69 | perturbation | lat0=15 | M=5  | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=15 |
sim70 | perturbation | lat0=15 | M=10 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=15 |
sim71 | perturbation | lat0=15 | M=15 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=15 |
sim72 | perturbation | lat0=15 | M=18 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=15 |
sim73 | perturbation | lat0=60 | M=5  | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=15 |
sim74 | perturbation | lat0=60 | M=10 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=15 |
sim75 | perturbation | lat0=60 | M=15 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=15 |
sim76 | perturbation | lat0=60 | M=18 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=15 |

sim77 | perturbation | lat0=15 | M=5  | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=0.5 |
sim78 | perturbation | lat0=15 | M=10 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=0.5 |
sim79 | perturbation | lat0=15 | M=15 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=0.5 |
sim80 | perturbation | lat0=15 | M=18 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=0.5 |
sim81 | perturbation | lat0=60 | M=5  | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=0.5 |
sim82 | perturbation | lat0=60 | M=10 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=0.5 |
sim83 | perturbation | lat0=60 | M=15 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=0.5 |
sim84 | perturbation | lat0=60 | M=18 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=0.5 |

sim85 | perturbation | lat0=15 | M=5  | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=0.1 |
sim86 | perturbation | lat0=15 | M=10 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=0.1 |
sim87 | perturbation | lat0=15 | M=15 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=0.1 |
sim88 | perturbation | lat0=15 | M=18 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=0.1 |
sim89 | perturbation | lat0=60 | M=5  | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=0.1 |
sim90 | perturbation | lat0=60 | M=10 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=0.1 |
sim91 | perturbation | lat0=60 | M=15 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=0.1 |
sim92 | perturbation | lat0=60 | M=18 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=0.1 |

sim93  | perturbation | lat0=15 | M=5  | full_no_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=5 |
sim94  | perturbation | lat0=15 | M=10 | full_no_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=5 |
sim95  | perturbation | lat0=15 | M=15 | full_no_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=5 |
sim96  | perturbation | lat0=15 | M=18 | full_no_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=5 |
sim97  | perturbation | lat0=60 | M=5  | full_no_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=5 |
sim98  | perturbation | lat0=60 | M=10 | full_no_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=5 |
sim99  | perturbation | lat0=60 | M=15 | full_no_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=5 |
sim100 | perturbation | lat0=60 | M=18 | full_no_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=5 |

# EFE results
# no wvf
#gaussian_spread1=10
sim45: 15, 4.94, 5,  -1.5916657723569547
sim46: 15, 4.94, 10, -2.9614363673422153
sim47: 15, 4.94, 15, -4.1669575379738646
sim48: 15, 4.94, 18, -4.8280824570009155
sim49: 60, 9.89, 5,  -0.3572446459302813
sim50: 60, 9.89, 10, -0.7066951431770163
sim51: 60, 9.89, 15, -1.0534624231683849
sim52: 60, 9.89, 18, -1.2628755675775780
#gaussian_spread1=5
sim93:  15,  4.94, 5,  -1.5112325865973557
sim94:  15,  4.94, 10, -2.8353677150425840
sim95:  15,  4.94, 15, -4.0282048866196467
sim96:  15,  4.94, 18, -4.6956453531350419
sim97:  60,  9.89, 5,  -0.3378324625565640
sim98:  60,  9.89, 10, -0.6695194537869197
sim99:  60,  9.89, 15, -0.9988910906483932
sim100: 60,  9.89, 18, -1.1986970446045195

# wvf
#gaussian_spread1=0.1
sim85: 15, 4.94, 5,  -2.4825361502790666
sim86: 15, 4.94, 10, -4.5523608128747881
sim87: 15, 4.94, 15, -6.4857809379034181
sim88: 15, 4.94, 18, -7.5061825566683096
sim89: 60, 9.89, 5,  -0.9397074428861178
sim90: 60, 9.89, 10, -1.6060963536853623
sim91: 60, 9.89, 15, -2.4749282966094732
sim92: 60, 9.89, 18, -2.9387130406460820
#gaussian_spread1=0.5
sim77: 15, 4.94, 5,  -2.4779607378418378
sim78: 15, 4.94, 10, -4.5645470630951941
sim79: 15, 4.94, 15, -6.4819548313616764
sim80: 15, 4.94, 18, -7.5073984962141269
sim81: 60, 9.89, 5,  -0.9238172057670537
sim82: 60, 9.89, 10, -1.6320498458707251
sim83: 60, 9.89, 15, -2.4682130745028248
sim84: 60, 9.89, 18, -2.9236570392511934
#gaussian_spread1=2
sim61: 15, 4.94, 5,  -2.4750341453338454
sim62: 15, 4.94, 10, -4.5689701023052560
sim63: 15, 4.94, 15, -6.4782207122961939
sim64: 15, 4.94, 18, -7.5051207999746889
sim65: 60, 9.89, 5,  -0.9152626377272597
sim66: 60, 9.89, 10, -1.6446020672361223
sim67: 60, 9.89, 15, -2.4651740313813870
sim68: 60, 9.89, 18, -2.9163396328907343
#gaussian_spread1=5
sim53: 15, 4.94, 5,  -2.4726204969475534
sim54: 15, 4.94, 10, -4.5680990552587781
sim55: 15, 4.94, 15, -6.4723546421838298
sim56: 15, 4.94, 18, -7.4999258230063779
sim57: 60, 9.89, 5,  -0.9099198250036619
sim58: 60, 9.89, 10, -1.6489771372096687
sim59: 60, 9.89, 15, -2.4635508491408515
sim60: 60, 9.89, 18, -2.9130917115943804
#gaussian_spread1=10
sim37: 15, 4.94, 5,  -2.4691280649892948
sim38: 15, 4.94, 10, -4.5657596295947558
sim39: 15, 4.94, 15, -6.4627919835991019
sim40: 15, 4.94, 18, -7.4905004558989203
sim41: 60, 9.89, 5,  -0.9007737951193726
sim42: 60, 9.89, 10, -1.6541595843329675
sim43: 60, 9.89, 15, -2.4601513532319128
sim44: 60, 9.89, 18, -2.9083547947150299
#gaussian_spread1=15
sim69: 15, 4.94, 5,  -2.4638333014884073
sim70: 15, 4.94, 10, -4.5600348546104845
sim71: 15, 4.94, 15, -6.4495817316482800
sim72: 15, 4.94, 18, -7.4765071510544301
sim73: 60, 9.89, 5,  -0.8927612348056017
sim74: 60, 9.89, 10, -1.6609440345329189
sim75: 60, 9.89, 15, -2.4583530435298759
sim76: 60, 9.89, 18, -2.9054364337455789

# Choosing gaussian_spread1=5
sim101 | annual_mean_clark | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=5 |
sim102 | annual_mean_clark | full_no_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian |

# The fitted A, B
sim103 | perturbation | lat0=15 | M=5  | linear | A=-452.68 | B=2.51 | accidentally overwritten :(  
sim104 | perturbation | lat0=15 | M=10 | linear | A=-452.68 | B=2.51 | accidentally overwritten :(
sim105 | perturbation | lat0=15 | M=15 | linear | A=-452.68 | B=2.51 | accidentally overwritten :(
sim106 | perturbation | lat0=15 | M=18 | linear | A=-452.68 | B=2.51 |
sim107 | perturbation | lat0=60 | M=5  | linear | A=-452.68 | B=2.51 |
sim108 | perturbation | lat0=60 | M=10 | linear | A=-452.68 | B=2.51 |
sim109 | perturbation | lat0=60 | M=15 | linear | A=-452.68 | B=2.51 |
sim110 | perturbation | lat0=60 | M=18 | linear | A=-452.68 | B=2.51 |
sim111 | perturbation | lat0=15 | M=5  | linear | A=-448.73 | B=2.50 |
sim112 | perturbation | lat0=15 | M=10 | linear | A=-448.73 | B=2.50 |
sim113 | perturbation | lat0=15 | M=15 | linear | A=-448.73 | B=2.50 |
sim114 | perturbation | lat0=15 | M=18 | linear | A=-448.73 | B=2.50 |
sim115 | perturbation | lat0=60 | M=5  | linear | A=-448.73 | B=2.50 |
sim116 | perturbation | lat0=60 | M=10 | linear | A=-448.73 | B=2.50 |
sim117 | perturbation | lat0=60 | M=15 | linear | A=-448.73 | B=2.50 |
sim118 | perturbation | lat0=60 | M=18 | linear | A=-448.73 | B=2.50 |

# wvf
sim103: 15, 4.94, 5,  -2.4096553007944470
sim104: 15, 4.94, 10, -4.5363085069089637
sim105: 15, 4.94, 15, -6.4430431617864627
sim106: 15, 4.94, 18, -7.4959671344414023
sim107: 60, 9.89, 5,  -0.8609869201245035
sim108: 60, 9.89, 10, -1.6456144287159502
sim109: 60, 9.89, 15, -2.3675494022788608
sim110: 60, 9.89, 18, -2.7689740114898918
# no wvf
sim111: 15, 4.94, 5,  -2.4126870577289909
sim112: 15, 4.94, 10, -4.5434452876711404
sim113: 15, 4.94, 15, -6.4519735774198921
sim114: 15, 4.94, 18, -7.5050152320612096
sim115: 60, 9.89, 5,  -0.8620308748135537
sim116: 60, 9.89, 10, -1.6511469892765396
sim117: 60, 9.89, 15, -2.3702073861341288
sim118: 60, 9.89, 18, -2.7707160026373625

---
# 8-6
---
After looking at SW - LW integral, we realized that my cartesian coordinates solution 
is not exactly the same as if you solve the diffusion equation in spherical
coordinate (btw, Earth is spherical. Go figure). So the new code solves the adjusted
PDE with a method from Brian Rose 
(https://climlab.readthedocs.io/en/latest/api/climlab.dynamics.Diffusion.html).

New method of calculating error: 
  |dT/dt| = max( |Ti - Ti-1| ) / time btwn i and i-1

# Accuracy experiments with new error calculation and integration scheme
# (all using M = 18 tropical perturbation, planck OLR, implicit scheme)
dlat | dtmax_mult | tol   | ITCZ
0.5  | 1.0        | 1E-10 | -5.78
0.5  | 1.0        | 1E-9  | -5.78
0.5  | 1.0        | 1E-8  | -5.78 
0.5  | 1.0        | 1E-7  | -5.77  ==> tol = 1E-7 is too small
0.5  | 0.5        | 1E-8  | -5.78
0.5  | 1.5        | 1E-8  | -5.78  ***
0.5  | 2.0        | 1E-8  | -5.77  ==> dtmax_mult = 2.0 is too large
1.0  | 1.5        | 1E-8  | -5.77  ==> dlat = 1.0 is too large
0.25 | 1.5        | 1E-8  | -5.78  ==> dlat = 0.25 is not necessary

Conclusion: dlat = 0.5, dtmax_mult = 1.5, tol = 1E-8 give fastest results while
    remaining accurate.

---
# 8-7
---
# Looking at planck feedback forcing and water vapor feedback forcing
sim103 | annual_mean_clark | full_wvf    | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=5 |
sim104 | annual_mean_clark | full_no_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=5 |
sim105 | annual_mean_clark | full_no_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=5 | constant_spec_hum=True
    ---> sim105 gives /data/L_array_constant_q_steps_mid_level_gaussian5_n361.npz

# Testing sensitivities (note, dtmax_mult = 10.0 and tol = 1E-7)
# full_wvf
L0  S     M   EFE                  ITCZ
15, 4.94, 18, -8.9222023431231428, -5.7102094995988111
15, 4.94, 15, -7.8151183831679960, -5.0016757652275174
15, 4.94, 10, -5.5927186602160139, -3.5793399425382488
15, 4.94,  5, -3.0709810908189650, -1.9654278981241375
60, 9.89, 18, -3.0793976194162953, -1.9708144764264290
60, 9.89, 15, -2.6207891845080660, -1.6773050780851622
60, 9.89, 10, -1.9152314381793913, -1.2257481204348104
60, 9.89,  5, -1.0021850723920951, -0.6413984463309409
# full_no_wvf
L0  S     M   EFE                  ITCZ
15, 4.94, 18, -5.4880324620232797, -3.5123407756948990
15, 4.94, 15, -4.7134997268545584, -3.0166398251869175
15, 4.94, 10, -3.3345732838137963, -2.1341269016408297
15, 4.94,  5, -1.7929847803388312, -1.1475102594168520
60, 9.89, 18, -1.1243505107295861, -0.7195843268669352
60, 9.89, 15, -0.9475412883755877, -0.6064264245603761
60, 9.89, 10, -0.6444894591439709, -0.4124732538521414
60, 9.89,  5, -0.3291728417761017, -0.2106706187367051

---
# 8-9
---
# Testing a hypothesis with feedback shifts
# --> These results will be redone tomorrow; it looks like they are sensitive to initial conditions

## Tropics

# M = 5
EFE: -3.08E+00 deg
Integral S - L from SP to EQ: 5.88E+14 W/m
F(0):                         9.72E+14 W/m
EFE approx with NEI:  -1.85E+00 deg
EFE approx with F(0): -3.05E+00 deg

Shift no_fb:     -2.38E+00 deg
Shift planck_fb: -1.67E+00 deg
Shift wv_fb1:    -8.12E-01 deg
Shift wv_fb2:    -2.36E+00 deg

# M = 10
EFE: -5.57E+00 deg
Integral S - L from SP to EQ: 1.51E+15 W/m
F(0):                         1.81E+15 W/m
EFE approx with NEI:  -4.53E+00 deg
EFE approx with F(0): -5.42E+00 deg

Shift no_fb:     -5.76E+00 deg
Shift planck_fb: -3.90E+00 deg
Shift wv_fb1:    -4.00E+00 deg
Shift wv_fb2:    -5.88E+00 deg

# M = 15
EFE: -7.83E+00 deg
Integral S - L from SP to EQ: 2.28E+15 W/m
F(0):                         2.57E+15 W/m
EFE approx with NEI:  -6.62E+00 deg
EFE approx with F(0): -7.46E+00 deg

Shift no_fb:     -8.82E+00 deg
Shift planck_fb: -5.77E+00 deg
Shift wv_fb1:    -6.50E+00 deg
Shift wv_fb2:    -9.16E+00 deg

# M = 18
EFE: -8.95E+00 deg
Integral S - L from SP to EQ: 2.68E+15 W/m
F(0):                         2.99E+15 W/m
EFE approx with NEI:  -7.65E+00 deg
EFE approx with F(0): -8.53E+00 deg

Shift no_fb:     -1.05E+01 deg
Shift planck_fb: -6.71E+00 deg
Shift wv_fb1:    -7.65E+00 deg
Shift wv_fb2:    -1.10E+01 deg

## Extratropics

# M = 5
EFE: -1.11E+00 deg
Integral S - L from SP to EQ: 7.24E+14 W/m
F(0):                         3.36E+14 W/m
EFE approx with NEI:  -2.39E+00 deg
EFE approx with F(0): -1.11E+00 deg

Shift no_fb:     -5.19E+00 deg
Shift planck_fb: -1.54E+00 deg
Shift wv_fb1:    -3.42E+00 deg
Shift wv_fb2:    -5.81E+00 deg

# M = 10
EFE: -1.88E+00 deg
Integral S - L from SP to EQ: 5.81E+14 W/m
F(0):                         5.81E+14 W/m
EFE approx with NEI:  -1.87E+00 deg
EFE approx with F(0): -1.87E+00 deg

Shift no_fb:     -6.97E+00 deg
Shift planck_fb: -1.22E+00 deg
Shift wv_fb1:    -1.88E+00 deg
Shift wv_fb2:    -7.94E+00 deg

# M = 15
EFE: -2.72E+00 deg
Integral S - L from SP to EQ: 7.78E+14 W/m
F(0):                         8.50E+14 W/m
EFE approx with NEI:  -2.46E+00 deg
EFE approx with F(0): -2.69E+00 deg

Shift no_fb:     -1.02E+01 deg
Shift planck_fb: -1.68E+00 deg
Shift wv_fb1:    -2.38E+00 deg
Shift wv_fb2:    -1.16E+01 deg

# M = 18
EFE: -3.13E+00 deg
Integral S - L from SP to EQ: 8.93E+14 W/m
F(0):                         9.91E+14 W/m
EFE approx with NEI:  -2.80E+00 deg
EFE approx with F(0): -3.11E+00 deg

Shift no_fb:     -1.23E+01 deg
Shift planck_fb: -2.05E+00 deg
Shift wv_fb1:    -2.70E+00 deg
Shift wv_fb2:    -1.41E+01 deg

---
# 8-10
---
# Redo of feedback sims (this time on savio with init condiation Legendre and high res in time)
sim119 | perturbation | lat0=15 | M=5  | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=5 |
sim120 | perturbation | lat0=15 | M=10 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=5 |
sim121 | perturbation | lat0=15 | M=15 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=5 |
sim122 | perturbation | lat0=15 | M=18 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=5 |
sim123 | perturbation | lat0=60 | M=5  | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=5 |
sim124 | perturbation | lat0=60 | M=10 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=5 |
sim125 | perturbation | lat0=60 | M=15 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=5 |
sim126 | perturbation | lat0=60 | M=18 | full_wvf | RH_vert_profile=steps | RH_lat_profile=mid_level_gaussian | gaussian_spread1=5 |

## Tropics
# M = 5
Integral S - L from SP to EQ: 0.99 PW/m
F(0):                         0.96 PW/m
EFE approx with NEI:  -3.17 deg
EFE approx with F(0): -3.06 deg

true EFE:              -3.09 deg
no_fb:                 -3.70 deg
planck_fb:             -2.53 deg
wv_fb1:                -3.30 deg
wv_fb2:                -3.73 deg
planck_fb + wv_fb1:    -1.80 deg
planck_fb + wv_fb2:    -2.52 deg

# M = 10
Integral S - L from SP to EQ: 1.86 PW/m
F(0):                         1.83 PW/m
EFE approx with NEI:  -5.65 deg
EFE approx with F(0): -5.57 deg

true EFE:              -5.77 deg
no_fb:                 -6.94 deg
planck_fb:             -4.63 deg
wv_fb1:                -5.98 deg
wv_fb2:                -7.07 deg
planck_fb + wv_fb1:    -3.16 deg
planck_fb + wv_fb2:    -4.67 deg

# M = 15
Integral S - L from SP to EQ: 2.60 PW/m
F(0):                         2.58 PW/m
EFE approx with NEI:  -7.66 deg
EFE approx with F(0): -7.59 deg

true EFE:              -7.92 deg
no_fb:                 -10.01 deg
planck_fb:             -6.47 deg
wv_fb1:                -8.22 deg
wv_fb2:                -10.44 deg
planck_fb + wv_fb1:    -4.10 deg
planck_fb + wv_fb2:    -6.66 deg

# M = 18
Integral S - L from SP to EQ: 3.03 PW/m
F(0):                         3.01 PW/m
EFE approx with NEI:  -8.78 deg
EFE approx with F(0): -8.71 deg

true EFE:              -9.06 deg
no_fb:                 -11.79 deg
planck_fb:             -7.47 deg
wv_fb1:                -9.44 deg
wv_fb2:                -12.43 deg
planck_fb + wv_fb1:    -4.57 deg
planck_fb + wv_fb2:    -7.79 deg

## Extratropics
# M = 5
Integral S - L from SP to EQ: 0.34 PW/m
F(0):                         0.31 PW/m
EFE approx with NEI:  -1.15 deg
EFE approx with F(0): -1.04 deg

true EFE:              -1.04 deg
no_fb:                 -3.86 deg
planck_fb:             -0.74 deg
wv_fb1:                -1.23 deg
wv_fb2:                -4.42 deg
planck_fb + wv_fb1:    1.71 deg
planck_fb + wv_fb2:    -1.01 deg

# M = 10
Integral S - L from SP to EQ: 0.64 PW/m
F(0):                         0.61 PW/m
EFE approx with NEI:  -2.08 deg
EFE approx with F(0): -1.98 deg

true EFE:              -1.99 deg
no_fb:                 -7.46 deg
planck_fb:             -1.38 deg
wv_fb1:                -2.15 deg
wv_fb2:                -8.50 deg
planck_fb + wv_fb1:    3.11 deg
planck_fb + wv_fb2:    -1.83 deg

# M = 15
Integral S - L from SP to EQ: 0.91 PW/m
F(0):                         0.88 PW/m
EFE approx with NEI:  -2.92 deg
EFE approx with F(0): -2.84 deg

true EFE:              -2.86 deg
no_fb:                 -10.94 deg
planck_fb:             -2.00 deg
wv_fb1:                -3.01 deg
wv_fb2:                -12.45 deg
planck_fb + wv_fb1:    4.19 deg
planck_fb + wv_fb2:    -2.61 deg

# M = 18
Integral S - L from SP to EQ: 1.06 PW/m
F(0):                         1.03 PW/m
EFE approx with NEI:  -3.38 deg
EFE approx with F(0): -3.29 deg

true EFE:              -3.33 deg
no_fb:                 -12.99 deg
planck_fb:             -2.38 deg
wv_fb1:                -3.48 deg
wv_fb2:                -14.79 deg
planck_fb + wv_fb1:    4.73 deg
planck_fb + wv_fb2:    -3.07 deg

# Summary:
Simulation  | True EFE | No FB  | Planck | WV     | Planck and WV
------------------------------------------------------------------
L0=15; M= 5 | -3.09    | -3.70  | -2.53  | -3.73  | -2.52
L0=15; M=10 | -5.77    | -6.94  | -4.63  | -7.07  | -4.67
L0=15; M=15 | -7.92    | -10.01 | -6.47  | -10.44 | -6.66
L0=15; M=18 | -9.06    | -11.79 | -7.47  | -12.43 | -7.79
L0=60; M= 5 | -1.04    | -3.86  | -0.74  | -4.42  | -1.01
L0=60; M=10 | -1.99    | -7.46  | -1.38  | -8.50  | -1.83
L0=60; M=15 | -2.86    | -10.94 | -2.00  | -12.45 | -2.61
L0=60; M=18 | -3.33    | -12.99 | -2.38  | -14.79 | -3.07

---
# 8-13
---

